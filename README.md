# Raft command line interface

Raft is an opinionated operating environment for the Espressif ESP32 family - see [further information on Raft](https://github.com/robdobsn/RaftCore)

This command-line application is used to scaffold raft apps and provide serial monitoring for them.

## Usage


### Creating a new raft application:

```
$ raft new .
```
This creates a new raft app in the current folder. Change . to your choice of folder to create the app elsewhere.

You will be asked a series of questions including the name of your app, target chip, etc.


After execution you will have a folder structure like this:

```
├───components
│   └───MySysMod
├───main
└───systypes
    ├───Common
    │   ├───FSImage
    │   └───WebUI
    └───SysTypeMain
```

Additional options are available ...

```
Create a new raft app

Usage: raft new [OPTIONS] [BASE_FOLDER]

Arguments:
  [BASE_FOLDER]

Options:
  -c, --clean  Clean the target folder
  -h, --help   Print help
```

### Monitoring a Serial port

```
raft monitor <port>
```
Where <port> is the serial port to be monitored

Additional options:

```
Monitor a serial port

Usage: raft.exe monitor [OPTIONS] [PORT]

Arguments:
  [PORT]

Options:
  -b, --baud <BAUD>              Baud rate
  -l, --log                      Log serial data to file
  -g, --log-folder <LOG_FOLDER>  Folder for log files [default: ./logs]
  -h, --help                     Print help
```

To exit the app press ESC

## Installation

You can either install this app from the crates.io package registry (which is part of the Rust ecosystem) or build from source code.

Either way you first need to install Rust (since you are here I assume you are interested in embedded development and Rust may be in your future in any case :)

Follow the steps to [install rust](https://www.rust-lang.org/tools/install)

Then install the app with:

```
cargo install raftcli
```

### Build from source

If you want to build this app from source code then firstly [install rust](https://www.rust-lang.org/tools/install)

Clone the repo:

```
git clone https://github.com/robdobsn/RaftCLI
cd RaftCLI
cargo install --path .
```

This will build and install the app into the binary executables folder that cargo uses.

## Template App Details

New raft apps are "scaffolded" using template information in the raft_templates folder.

The handlebars templating library is used to fill in the gaps in the templates based on the answers to questions asked when running "raft new".

In addition to generating source code, build files are generated for various build scenarios including:

* building natively on linux
* building using docker on mac, linux and windows

The best way to build a raft application depends on your OS and requirements. I primarily use a Windows machine with Ubuntu in WSL (google this if you are not familiar with running linux with the Windows Subsystem for Linux).  I find this is the best combination of speed and convenience and the Makefile generated by this app works well in that scenario when run from a WSL prompt.